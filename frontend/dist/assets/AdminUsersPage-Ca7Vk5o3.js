import{e as v,f as i,j as e,J as w}from"./index-CzFFDwW4.js";import{b as r}from"./vendor-Ckni1CTx.js";import{a as h}from"./adminApi-BAsvNbCX.js";function A(){const[t,x]=r.useState(null),[m,s]=r.useState(!0),[d,n]=r.useState(1),[l,o]=r.useState(""),[u,f]=r.useState(null),[j,g]=r.useState(!1),{user:y}=v();r.useEffect(()=>{p()},[d,l]);const p=async()=>{s(!0);try{const a=await h.getUsers(d,20,l);x(a)}catch{i.error("Erro ao carregar usuários")}finally{s(!1)}},k=async(a,c)=>{try{if(a===y?.id){i.error("Você não pode alterar seu próprio status de admin");return}if(!confirm(`Tem certeza que deseja ${c?"remover":"adicionar"} privilégios de admin?`))return;await h.updateUserAdminStatus(a,!c),i.success("Status atualizado com sucesso"),p()}catch{i.error("Erro ao atualizar status")}},N=async(a,c,b)=>{try{await h.updateUserPlan(a,c,b),i.success("Plano atualizado com sucesso"),g(!1),p()}catch{i.error("Erro ao atualizar plano")}};return e.jsxs("div",{className:"container mx-auto px-4 py-6 lg:px-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Gerenciar Usuários"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx("input",{type:"text",placeholder:"Buscar por nome, email ou telefone...",className:"flex-1 p-2 border rounded-md dark:bg-gray-800 dark:border-gray-700 dark:text-white",value:l,onChange:a=>o(a.target.value)})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Usuário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Plano"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Uso"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Admin"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Criado em"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:m&&!t?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-4 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(w,{})})})}):t?.items.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a.name}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.email}),e.jsx("span",{className:"text-xs text-gray-400",children:a.id})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                        ${a.plan.toUpperCase()==="ENTERPRISE"?"bg-purple-100 text-purple-800":a.plan.toUpperCase()==="PREMIUM"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:a.plan})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:a.usage_count}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:a.is_admin?e.jsx("span",{className:"text-green-600 font-bold",children:"Sim"}):e.jsx("span",{className:"text-gray-400",children:"Não"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx("button",{onClick:()=>k(a.id,a.is_admin),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",disabled:a.id===y?.id,children:a.is_admin?"Remover Admin":"Tornar Admin"}),e.jsx("button",{onClick:()=>{f(a),g(!0)},className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",children:"Alterar Plano"})]})})]},a.id))})]})}),t&&e.jsx("div",{className:"px-6 py-3 flex items-center justify-between border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>n(Math.max(1,d-1)),disabled:d===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Anterior"}),e.jsx("button",{onClick:()=>n(d+1),disabled:d*20>=t.total,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Próxima"})]})})]})]}),j&&u&&e.jsx(E,{user:u,onClose:()=>g(!1),onUpdate:N})]})}function E({user:t,onClose:x,onUpdate:m}){const[s,d]=r.useState(t.plan),[n,l]=r.useState(30);return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-md p-6 border border-gray-200 dark:border-gray-700 animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold dark:text-white",children:"Alterar Plano"}),e.jsx("button",{onClick:x,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Usuário"}),e.jsxs("p",{className:"font-medium dark:text-white",children:[t.name," (",t.email,")"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Selecionar Plano"}),e.jsxs("select",{value:s,onChange:o=>d(o.target.value),className:"w-full p-2.5 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white ring-offset-background focus:ring-2 focus:ring-green-500 transition-all",children:[e.jsx("option",{value:"free",children:"Gratuito (FREE)"}),e.jsx("option",{value:"premium",children:"Premium (PREMIUM)"}),e.jsx("option",{value:"enterprise",children:"Enterprise (ENTERPRISE)"})]})]}),s!=="FREE"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Duração (dias)"}),e.jsx("input",{type:"number",value:n,onChange:o=>l(parseInt(o.target.value)||0),className:"w-full p-2.5 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white ring-offset-background focus:ring-2 focus:ring-green-500 transition-all",min:"1",max:"3650"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["O plano expirará em ",n," dias a partir de agora."]})]}),s==="FREE"&&e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/30 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsxs("p",{className:"text-xs text-yellow-800 dark:text-yellow-200",children:[e.jsx("strong",{children:"Nota:"})," Downgrades para FREE removem a expiração. O usuário terá limites de mensagens e jobs restaurados."]})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:()=>m(t.id,s,s==="FREE"?void 0:n),className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg shadow-lg shadow-green-900/10 transition-colors",children:"Salvar Alterações"})]})]})]})})}export{A as AdminUsersPage};
