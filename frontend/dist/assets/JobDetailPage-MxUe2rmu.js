import{j as e,a as b,l as N,H as j,h as v,k as C}from"./index-CzFFDwW4.js";import{C as y,a as w,u as _}from"./useJobs-CdiVa7YV.js";import{C as k}from"./circle-stop-BFqtyt86.js";import{A as P}from"./arrow-left-CHJnVdfb.js";import{M as R,p as J}from"./pt-BR-DdiBCKyI.js";import{a as p,C as A}from"./clock-B_u0nPIZ.js";import{H as u}from"./hash-Qq1vW8NH.js";import{A as E}from"./arrow-right-B8JQ2zer.js";import{Z as L}from"./zap-BQlWyOVR.js";import{I as S}from"./image-CaHbtvT8.js";import{u as h,g as H,b as M}from"./vendor-Ckni1CTx.js";import{f as D}from"./format-Dg3nb9Bm.js";import"./jobs.api-DIjWZGWd.js";function B({job:s,onStop:a,onPause:t,onResume:l,onRefresh:d,isStoppingJob:i,isPausingJob:o,isResumingJob:c,className:m}){const n=s.status==="running",r=s.status==="paused",x=n||s.status==="pending"||r;return e.jsxs("div",{className:b("flex items-center gap-3",m),children:[d&&e.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 border rounded-md hover:bg-accent transition-colors",title:"Atualizar dados",children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Atualizar"})]}),n&&t&&e.jsxs("button",{onClick:()=>t(s.id),disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-orange-500/10 text-orange-500 hover:bg-orange-500/20 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:o?"Pausando...":"Pausar"})]}),r&&l&&e.jsxs("button",{onClick:()=>l(s.id),disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-primary/10 text-primary hover:bg-primary/20 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(w,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:c?"Retomar":"Continuar"})]}),x&&a&&e.jsxs("button",{onClick:()=>a(s.id),disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-destructive/10 text-destructive hover:bg-destructive/20 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:i?"Parando...":"Parar Job"})]})]})}const g=s=>{const a=s.endsWith("Z")?s:`${s}Z`,t=new Date(a);return D(t,"dd/MM/yyyy 'às' HH:mm:ss",{locale:J})};function I({job:s,onStop:a,onPause:t,onResume:l,onRefresh:d,isStoppingJob:i,isPausingJob:o,isResumingJob:c}){const m=h(),r={pending:{label:"Pendente",color:"text-muted-foreground",bgColor:"bg-muted"},running:{label:"Em Execução",color:"text-primary",bgColor:"bg-primary/10"},completed:{label:"Concluído",color:"text-success",bgColor:"bg-success/10"},failed:{label:"Falhou",color:"text-destructive",bgColor:"bg-destructive/10"},stopped:{label:"Parado",color:"text-warning",bgColor:"bg-warning/10"},paused:{label:"Pausado",color:"text-warning",bgColor:"bg-warning/10"}}[s.status];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>m("/jobs"),className:"p-2 hover:bg-accent rounded-md transition-colors",title:"Voltar para lista",children:e.jsx(P,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Detalhes do Job"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",s.id]})]})]}),e.jsx(B,{job:s,onStop:a,onPause:t,onResume:l,onRefresh:d,isStoppingJob:i,isPausingJob:o,isResumingJob:c})]}),e.jsxs("div",{className:"bg-card border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Status"}),e.jsx("div",{className:`px-3 py-1.5 rounded-full text-sm font-medium ${r.bgColor} ${r.color}`,children:r.label})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mensagens copiadas"}),e.jsx("p",{className:"text-xl font-bold text-foreground",children:s.messages_copied.toLocaleString("pt-BR")})]})]}),s.messages_failed>0&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{className:"h-5 w-5 text-destructive"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mensagens falhadas"}),e.jsx("p",{className:"text-xl font-bold text-destructive",children:s.messages_failed.toLocaleString("pt-BR")})]})]})]}),s.status==="failed"&&s.error_message&&e.jsxs("div",{className:"mt-4 p-3 bg-destructive/5 border border-destructive/20 rounded text-sm text-destructive",children:[e.jsx("span",{className:"font-medium",children:"Erro:"})," ",s.error_message]})]}),e.jsxs("div",{className:"bg-card border rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Configuração"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-muted-foreground",children:"Canais"}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(u,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:s.source_channel})]}),e.jsx(E,{className:"h-5 w-5 text-muted-foreground flex-shrink-0"}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(u,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:s.target_channel})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-muted-foreground",children:"Modo"}),e.jsx("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg",children:s.real_time?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"font-medium",children:"Tempo Real"}),e.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:"(Copia novas mensagens conforme chegam)"})]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Histórico"}),e.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:"(Copia mensagens existentes)"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-muted-foreground",children:"Opções"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg",children:[e.jsx(S,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:s.copy_media?"Copiar mídia habilitado":"Copiar apenas texto"})]})]})]})]}),e.jsxs("div",{className:"bg-card border rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Informações Temporais"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.created_at&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-muted-foreground",children:"Criado em"}),e.jsx("p",{className:"text-sm",children:g(s.created_at)})]}),(s.completed_at||s.started_at)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-muted-foreground",children:"Última atualização"}),e.jsx("p",{className:"text-sm",children:g(s.completed_at||s.started_at)})]})]})]}),e.jsxs("div",{className:"bg-card border rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Estatísticas"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-primary/10 rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Copiadas"}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.messages_copied.toLocaleString("pt-BR")})]}),e.jsxs("div",{className:"p-4 bg-destructive/10 rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Falharam"}),e.jsx("p",{className:"text-2xl font-bold text-destructive",children:s.messages_failed.toLocaleString("pt-BR")})]})]})]})]})}function X(){const{jobId:s}=H(),a=h(),{useJob:t,stopJob:l,pauseJob:d,resumeJob:i,isStoppingJob:o,isPausingJob:c,isResumingJob:m}=_(),{data:n,isLoading:r,error:x,refetch:f}=t(s||"");return M.useEffect(()=>{s||a("/jobs")},[s,a]),e.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",children:[e.jsx(j,{}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsx(v,{}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-background",children:e.jsx("div",{className:"container mx-auto px-4 py-6 lg:px-8",children:r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(C,{className:"h-8 w-8 animate-spin text-primary"})}):x?e.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-6 text-center",children:[e.jsx(p,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Erro ao carregar job"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Não foi possível carregar os detalhes do job."}),e.jsx("button",{onClick:()=>a("/jobs"),className:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors",children:"Voltar para lista"})]}):n?e.jsx(I,{job:n,onStop:l,onPause:d,onResume:i,onRefresh:f,isStoppingJob:o,isPausingJob:c,isResumingJob:m}):null})})]})]})}export{X as JobDetailPage};
