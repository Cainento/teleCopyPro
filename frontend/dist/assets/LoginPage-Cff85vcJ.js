import{c as f,e as j,t as b,f as h,g,R as k,j as e}from"./index-CzFFDwW4.js";import{u as C,b as u}from"./vendor-Ckni1CTx.js";import{u as P}from"./session.store-1UEN3RI7.js";import{o as y,s as x,u as v,a as w,L as F}from"./schemas-DA-md1ZL.js";import{P as L}from"./phone-D8kBdd1t.js";import{H as T}from"./hash-Qq1vW8NH.js";import{A}from"./arrow-left-CHJnVdfb.js";import{m as N,A as E}from"./proxy-BQrqb7Gx.js";import{C as $}from"./circle-check-big-Bbgtxqrf.js";const D=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],V=f("eye-off",D);const B=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],M=f("eye",B);const R=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],z=f("key",R);const q=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],O=f("shield-check",q);function U(){const s=C(),{login:n}=j(),{setStatus:d,setUserInfo:c}=P(),[a,i]=u.useState({currentStep:"phone",phoneNumber:"",apiId:0,apiHash:"",isLoading:!1}),t=u.useCallback(o=>{i(r=>({...r,...o}))},[]),m=u.useCallback(async o=>{t({isLoading:!0,error:void 0});try{const r=await b.sendCode({phone_number:o.phoneNumber,api_id:o.apiId,api_hash:o.apiHash});t({phoneNumber:o.phoneNumber,apiId:o.apiId,apiHash:o.apiHash,phoneCodeHash:r.phone_code_hash,currentStep:"code",isLoading:!1}),d("waiting_code"),h.success("Código de verificação enviado!")}catch(r){const l=g(r);t({error:l,isLoading:!1}),h.error(l)}},[t,d]),p=u.useCallback(async o=>{t({isLoading:!0,error:void 0});try{const r=await b.signIn({phone_number:a.phoneNumber,phone_code:o.code});if(r.requires_2fa||r.message.toLowerCase().includes("2fa")||r.message.toLowerCase().includes("password")){t({currentStep:"2fa",isLoading:!1}),d("waiting_password"),h.info("Autenticação de dois fatores necessária");return}if(r.user_id&&r.access_token)S(r.user_id,r.username,r.access_token,r.token_type||"bearer");else throw new Error("Resposta inválida do servidor")}catch(r){const l=g(r);l.toLowerCase().includes("2fa")||l.toLowerCase().includes("password")?(t({currentStep:"2fa",isLoading:!1}),d("waiting_password"),h.info("Autenticação de dois fatores necessária")):(t({error:l,isLoading:!1}),h.error(l))}},[a.phoneNumber,t,d]),I=u.useCallback(async o=>{t({isLoading:!0,error:void 0});try{const r=await b.signIn2FA({phone_number:a.phoneNumber,password:o.password});if(r.user_id&&r.access_token)S(r.user_id,r.username,r.access_token,r.token_type||"bearer");else throw new Error("Resposta inválida do servidor")}catch(r){const l=g(r);t({error:l,isLoading:!1}),h.error(l)}},[a.phoneNumber,t]),S=u.useCallback((o,r,l,H)=>{n({phoneNumber:a.phoneNumber,userId:o,username:r,apiId:a.apiId,apiHash:a.apiHash,isAuthenticated:!0,accessToken:l,tokenType:H,expiresAt:Date.now()+10080*60*1e3}),j.getState().checkSession(),d("connected"),c(o,r),t({userId:o,username:r,currentStep:"success",isLoading:!1}),h.success(`Autenticado como ${r?`@${r}`:a.phoneNumber}!`),setTimeout(()=>{s(k.DASHBOARD)},1e3)},[a.phoneNumber,a.apiId,a.apiHash,n,d,c,t,s]),_=u.useCallback(()=>{i(o=>o.currentStep==="code"?{...o,currentStep:"phone",error:void 0}:o.currentStep==="2fa"?{...o,currentStep:"code",error:void 0}:o)},[]);return{state:a,updateState:t,handlePhoneStep:m,handleCodeStep:p,handleTwoFactorStep:I,handleBack:_}}const W=y({phoneNumber:x().min(1,"Número de telefone obrigatório").regex(/^\+?[1-9]\d{1,14}$/,"Formato inválido. Use +55 seguido do número"),apiId:x().min(1,"API ID obrigatório").regex(/^\d+$/,"API ID deve conter apenas números"),apiHash:x().min(1,"API Hash obrigatório").min(32,"API Hash deve ter pelo menos 32 caracteres")}),K=y({code:x().min(1,"Código obrigatório").regex(/^\d{5}$/,"Código deve ter 5 dígitos")}),G=y({password:x().min(1,"Senha obrigatória").min(1,"Senha não pode estar vazia")});function J({onSubmit:s,isLoading:n,error:d}){const{register:c,handleSubmit:a,formState:{errors:i}}=v({resolver:w(W),mode:"onBlur"}),t=m=>{const p={...m,apiId:Number(m.apiId)};s(p)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Autenticação Telegram"}),e.jsx("p",{className:"text-muted-foreground",children:"Insira seu número de telefone e credenciais da API do Telegram"})]}),e.jsxs("form",{onSubmit:a(t),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phoneNumber",className:"block text-sm font-medium mb-2",children:"Número de Telefone"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx("input",{...c("phoneNumber"),id:"phoneNumber",type:"tel",placeholder:"+5511999999999",className:`w-full pl-10 pr-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary ${i.phoneNumber?"border-destructive":"border-input"}`,disabled:n})]}),i.phoneNumber&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:i.phoneNumber.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"apiId",className:"block text-sm font-medium mb-2",children:"API ID"}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx("input",{...c("apiId",{valueAsNumber:!1}),id:"apiId",type:"text",placeholder:"1234567",className:`w-full pl-10 pr-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary ${i.apiId?"border-destructive":"border-input"}`,disabled:n})]}),i.apiId&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:i.apiId.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"apiHash",className:"block text-sm font-medium mb-2",children:"API Hash"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx("input",{...c("apiHash"),id:"apiHash",type:"text",placeholder:"abcdef1234567890abcdef1234567890",className:`w-full pl-10 pr-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary ${i.apiHash?"border-destructive":"border-input"}`,disabled:n})]}),i.apiHash&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:i.apiHash.message}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:e.jsx("a",{href:"https://my.telegram.org/apps",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Como obter suas credenciais da API →"})})]}),d&&e.jsx("div",{className:"p-3 bg-destructive/10 border border-destructive rounded-md",children:e.jsx("p",{className:"text-sm text-destructive",children:d})}),e.jsx("button",{type:"submit",disabled:n,className:"w-full bg-primary text-primary-foreground py-2 px-4 rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:n?"Enviando código...":"Enviar código de verificação"})]})]})}function Q({onSubmit:s,onBack:n,phoneNumber:d,isLoading:c,error:a}){const{register:i,handleSubmit:t,formState:{errors:m}}=v({resolver:w(K),mode:"onBlur"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-primary/10 rounded-full mb-4",children:e.jsx(O,{className:"h-8 w-8 text-primary"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Código de Verificação"}),e.jsxs("p",{className:"text-muted-foreground",children:["Enviamos um código de 5 dígitos para ",e.jsx("br",{}),e.jsx("span",{className:"font-medium text-foreground",children:d})]})]}),e.jsxs("form",{onSubmit:t(s),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"code",className:"block text-sm font-medium mb-2",children:"Código de Verificação"}),e.jsx("input",{...i("code"),id:"code",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:5,placeholder:"12345",className:`w-full text-center text-2xl tracking-widest py-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary ${m.code?"border-destructive":"border-input"}`,disabled:c,autoFocus:!0}),m.code&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:m.code.message}),e.jsx("p",{className:"mt-2 text-xs text-muted-foreground text-center",children:"Verifique o aplicativo do Telegram no seu celular"})]}),a&&e.jsx("div",{className:"p-3 bg-destructive/10 border border-destructive rounded-md",children:e.jsx("p",{className:"text-sm text-destructive",children:a})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{type:"submit",disabled:c,className:"w-full bg-primary text-primary-foreground py-2 px-4 rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:c?"Verificando...":"Verificar código"}),e.jsxs("button",{type:"button",onClick:n,disabled:c,className:"w-full flex items-center justify-center gap-2 text-muted-foreground hover:text-foreground transition-colors py-2 disabled:opacity-50",children:[e.jsx(A,{className:"h-4 w-4"}),"Voltar"]})]})]}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[e.jsx("p",{children:"Não recebeu o código?"}),e.jsx("button",{type:"button",onClick:n,className:"text-primary hover:underline font-medium",children:"Tentar novamente"})]})]})}function X({onSubmit:s,onBack:n,isLoading:d,error:c}){const[a,i]=u.useState(!1),{register:t,handleSubmit:m,formState:{errors:p}}=v({resolver:w(G),mode:"onBlur"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-primary/10 rounded-full mb-4",children:e.jsx(F,{className:"h-8 w-8 text-primary"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Autenticação de Dois Fatores"}),e.jsxs("p",{className:"text-muted-foreground",children:["Sua conta está protegida com 2FA. ",e.jsx("br",{}),"Insira sua senha do Telegram"]})]}),e.jsxs("form",{onSubmit:m(s),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium mb-2",children:"Senha 2FA"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{...t("password"),id:"password",type:a?"text":"password",placeholder:"Digite sua senha",className:`w-full pr-10 pl-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary ${p.password?"border-destructive":"border-input"}`,disabled:d,autoFocus:!0}),e.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",tabIndex:-1,children:a?e.jsx(V,{className:"h-5 w-5"}):e.jsx(M,{className:"h-5 w-5"})})]}),p.password&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:p.password.message}),e.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"Esta é a senha que você configurou no aplicativo do Telegram"})]}),c&&e.jsx("div",{className:"p-3 bg-destructive/10 border border-destructive rounded-md",children:e.jsx("p",{className:"text-sm text-destructive",children:c})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{type:"submit",disabled:d,className:"w-full bg-primary text-primary-foreground py-2 px-4 rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:d?"Verificando...":"Continuar"}),e.jsxs("button",{type:"button",onClick:n,disabled:d,className:"w-full flex items-center justify-center gap-2 text-muted-foreground hover:text-foreground transition-colors py-2 disabled:opacity-50",children:[e.jsx(A,{className:"h-4 w-4"}),"Voltar"]})]})]}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[e.jsx("p",{children:"Esqueceu sua senha?"}),e.jsx("a",{href:"https://telegram.org/faq#login-and-sms",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline font-medium",children:"Saiba como recuperar →"})]})]})}function Y({username:s,phoneNumber:n}){return e.jsxs("div",{className:"space-y-6 text-center",children:[e.jsx(N.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:15},className:"inline-flex items-center justify-center w-20 h-20 bg-success/10 rounded-full",children:e.jsx($,{className:"h-12 w-12 text-success"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Autenticação Concluída!"}),e.jsxs("p",{className:"text-muted-foreground",children:["Você está autenticado como ",e.jsx("br",{}),e.jsx("span",{className:"font-medium text-foreground",children:s?`@${s}`:n})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-muted-foreground animate-pulse"}),e.jsx("span",{children:"Redirecionando para o dashboard..."})]})]})}function Z(){const{state:s,handlePhoneStep:n,handleCodeStep:d,handleTwoFactorStep:c,handleBack:a}=U(),i=()=>{switch(s.currentStep){case"phone":return 1;case"code":return 2;case"2fa":return 3;case"success":return 4;default:return 1}},t=s.currentStep==="2fa"||s.currentStep==="success"?3:2;return e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[s.currentStep!=="success"&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:["Etapa ",i()," de ",t]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[Math.round(i()/t*100),"%"]})]}),e.jsx("div",{className:"h-2 bg-secondary rounded-full overflow-hidden",children:e.jsx(N.div,{className:"h-full bg-primary",initial:{width:0},animate:{width:`${i()/t*100}%`},transition:{duration:.3}})})]}),e.jsx("div",{className:"bg-card border rounded-lg shadow-lg p-8",children:e.jsx(E,{mode:"wait",children:e.jsxs(N.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[s.currentStep==="phone"&&e.jsx(J,{onSubmit:n,isLoading:s.isLoading,error:s.error}),s.currentStep==="code"&&e.jsx(Q,{onSubmit:d,onBack:a,phoneNumber:s.phoneNumber,isLoading:s.isLoading,error:s.error}),s.currentStep==="2fa"&&e.jsx(X,{onSubmit:c,onBack:a,isLoading:s.isLoading,error:s.error}),s.currentStep==="success"&&e.jsx(Y,{username:s.username,phoneNumber:s.phoneNumber})]},s.currentStep)})}),s.currentStep==="phone"&&e.jsx("div",{className:"mt-6 text-center text-sm text-muted-foreground",children:e.jsx("p",{children:"Suas credenciais são usadas apenas para autenticação e são armazenadas de forma segura no seu navegador."})})]})}function ce(){const s=C(),{isAuthenticated:n}=j();return u.useEffect(()=>{n&&s(k.DASHBOARD,{replace:!0})},[n,s]),e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-background to-muted/20 px-4 py-12",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-primary to-primary/60 bg-clip-text text-transparent mb-2",children:"TeleCopy Pro"}),e.jsx("p",{className:"text-muted-foreground",children:"Copie mensagens entre canais do Telegram com facilidade"})]}),e.jsx(Z,{}),e.jsx("div",{className:"mt-8 text-center text-sm text-muted-foreground",children:e.jsx("p",{children:"© 2025 TeleCopy Pro. Todos os direitos reservados."})})]})}export{ce as LoginPage};
